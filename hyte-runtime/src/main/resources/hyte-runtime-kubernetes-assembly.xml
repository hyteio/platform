<?xml version="1.0" encoding="UTF-8"?>
<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/ASSEMBLY/2.1.0 http://maven.apache.org/xsd/assembly-2.1.0.xsd">
  <id>kubernetes</id>

  <baseDirectory>/</baseDirectory>

  <formats>
    <format>tar.gz</format>
  </formats>

  <fileSets>
    <!-- 
		<fileSet>
			<directory>${project.build.directory}/unpack/docs</directory>
			<excludes>
				<exclude>**/META-INF/*</exclude>
			</excludes>
			<outputDirectory>hyte-runtime-${project.version}/docs</outputDirectory>
		</fileSet>
		-->
    <fileSet>
      <directory>${project.build.directory}/karaf-kubernetes/bin</directory>
      <outputDirectory>hyte-runtime-${project.version}/bin</outputDirectory>
      <includes>
        <include>**/**</include>
      </includes>
      <fileMode>0755</fileMode>
      <filtered>false</filtered>
    </fileSet>
    <fileSet>
      <directory>${project.build.directory}/karaf-unix/bin</directory>
      <outputDirectory>hyte-runtime-${project.version}/bin</outputDirectory>
      <includes>
        <include>**/**</include>
      </includes>
      <fileMode>0755</fileMode>
      <filtered>false</filtered>
    </fileSet>
        <fileSet>
      <directory>${project.build.directory}/karaf-kubernetes/etc</directory>
      <outputDirectory>hyte-runtime-${project.version}/etc</outputDirectory>
      <includes>
        <include>**/**</include>
      </includes>
    </fileSet>
    <fileSet>
      <directory>${project.build.directory}/karaf</directory>
      <outputDirectory>hyte-runtime-${project.version}</outputDirectory>
      <excludes>
        <exclude>.locks</exclude>
        <exclude>**/maven-metadata-local.xml</exclude>
        <exclude>**/_remote.repositories</exclude>
      </excludes>
      <includes>
        <include>**/**</include>
      </includes>
    </fileSet>
    <fileSet>
      <directory>${project.build.directory}/local-repo</directory>
      <outputDirectory>hyte-runtime-${project.version}/local-repo</outputDirectory>
      <excludes>
        <exclude>.locks</exclude>
        <exclude>**/maven-metadata-local.xml</exclude>
        <exclude>**/_remote.repositories</exclude>
      </excludes>
    </fileSet>
    <!-- Karaf last, since maven assembly does __NOT__ overwrite previous files. -->
    <fileSet>
      <directory>${project.build.directory}/karaf-unix/apache-karaf-${hyte.karaf.version}</directory>
      <outputDirectory>hyte-runtime-${project.version}</outputDirectory>
      <excludes>
        <exclude>**/bin/*.bat</exclude>
        <exclude>**/maven-metadata-local.xml</exclude>
        <exclude>**/_remote.repositories</exclude>
        <exclude>**/system/org/ops4j/pax/transx/**/0.5.0/**</exclude>
        <exclude>**/system/org/ow2/asm/asm*/9.3/**</exclude>
      </excludes>
    </fileSet>
  </fileSets>
  <files>
    <file>
      <source>src/main/resources/README.md</source>
      <filtered>true</filtered>
      <outputDirectory>hyte-runtime-${project.version}</outputDirectory>
    </file>
  </files>
</assembly>
